refactored from shared
added some bits
Hi from R1, I like R1.
